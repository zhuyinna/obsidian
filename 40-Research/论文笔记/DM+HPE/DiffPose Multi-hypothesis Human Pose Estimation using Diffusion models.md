---
Authors: Karl Holmquist; Bastian Wandt
Date: 2022-11
Topics: DM+HPE
DOI: 10.48550/arXiv.2211.16487
Keywords: multiple hypotheses with DM; pose sampler with transformer
---
tags: #论文笔记 

## Zotero Links 
- **Url**: [Open online](http://arxiv.org/abs/2211.16487)
- **zotero entry**: [Zotero](zotero://select/library/items/4WFU67HA)
- **open pdf**: [arXiv Fulltext PDF](file:///C:%5CUsers%5C%E7%A5%9D%E9%93%B6%E9%82%A3%5CDocuments%5CObsidian%20Vault%5Czotero%5Cstorage%5C2KA96763%5CHolmquist%20%E5%92%8C%20Wandt%20-%202022%20-%20DiffPose%20Multi-hypothesis%20Human%20Pose%20Estimation%20u.pdf)


## Abstract

Traditionally, monocular 3D human pose estimation employs a machine learning model to predict the most likely 3D pose for a given input image. However, a single image can be highly ambiguous and induces multiple plausible solutions for the 2D-3D lifting step which results in overly confident 3D pose predictors. To this end, we propose \emph{DiffPose}, a conditional diffusion model, that predicts multiple hypotheses for a given input image. In comparison to similar approaches, our diffusion model is straightforward and avoids intensive hyperparameter tuning, complex network structures, mode collapse, and unstable training. Moreover, we tackle a problem of the common two-step approach that first estimates a distribution of 2D joint locations via joint-wise heatmaps and consecutively approximates them based on first- or second-moment statistics. Since such a simplification of the heatmaps removes valid information about possibly correct, though labeled unlikely, joint locations, we propose to represent the heatmaps as a set of 2D joint candidate samples. To extract information about the original distribution from these samples we introduce our \emph{embedding transformer} that conditions the diffusion model. Experimentally, we show that DiffPose slightly improves upon the state of the art for multi-hypothesis pose estimation for simple poses and outperforms it by a large margin for highly ambiguous poses.


## Summary
  first DM+HPE: (和 generic diffusion-based approach 那一篇才是第一个)
  提出了 pose sampler：新的热图采样方法

## Conclusion
1. DiffPose：a conditional diffusion model, that estimates multiple hypotheses for 3D human pose estimation from a single image
2. 新颖的 heatmap sampling strategy: a novel sampling method from 2D joint heatmaps in combination with a **embedding transformer** to represent the uncertainties in the heatmaps：能够 use the full information in the 2D joint heatmaps
  downstream tasks: 3D pose tracking, multi-view pose estimation, and likelihood estimation for pose forecasting
  
  Q: 什么是 embedding transormer？ 和 [[A generic diffusion - based approach for 3D human pose prediction in the wild]] 里的 embedding 是否相同？

## Research Objective (s)
  Our goal is a multi-hypothesis human pose estimator that is easy to train and produces high-quality samples covering the full range of possible and plausible output poses. 
  Three contributions: 

1. are the first to represent a 3D human pose distribution with a **conditional diffusion model** which, in its surprisingly simple architecture and training, achieves state-of-the-art results
2. use the full 2D input information from heatmaps without any simplifications by our novel sampling strategy
3. **propose a transformer architecture** that handles these samples without losing information about joint uncertainties.

## Background / Problem Statement
  问题 1. 模型稳定性
  人体姿态估计模型：
  - GANs, VAEs: mode collapse, posterior collapse, vanishing gradients, and training instability
  - Normalizing flows: require a sophisticated model of the human kinematic chain [53], a kinematic chain prior [52], and additional care during training
  - Ours: it does not suffer from mode collapse, posterior collapse, vanishing gradients, and training instability

  问题 2. two-step approaches
  方法：first predict 2D joint positions in an image and consecutively use these predictions as input to the 3D reconstruction step
  缺陷：While this enables the 3D estimator to be agnostic to the input image and consequently promises generalization across image domains, it removes valid structural and depth information that can only be seen in the images.——namely the loss of valuable uncertainty information when mapping from heatmaps to joint positions.

## Method (s)
  ![[Pasted image 20230301142224.png]]
### 1. diffusion model
  问题 1. 利用扩散模型
  diffusion process——iterative distortion of a vector containing 3 D joint coordinates into a Gaussian distribution N (0, I)
  denoising process——is conditioned on joint-wise heatmaps that are generated by the 2 D joint detector HRNet [46] using our embedding transformer

### 2. sampling from heatmaps
  问题 2. 
  directly utilize the predicted joint position likelihoods to sample the heatmap and utilize both the samples themselves as well as their individual likelihoods to condition the reverse diffusion process
  具体采样方法：pose sampler
  In order to represent the heatmaps in a compact yet concise way, we interpret it as an independent, multinomial distribution over possible detections in a 64 × 64-grid (the output dimension of each heatmap from HRNet [46]) and draw n samples with replacement for each joint.

  模型框架：
  2D 检测器：HRNet (见 [[Net]]），采样 heatmap
  
### conditioning the diffusion model
  Embedding Transformer：
    1. joint-wise embedding
       ![[Pasted image 20230302153359.png|400]]
       ![[Pasted image 20230302153412.png|400]]
2. Inter-joint dependencies



## Experiment (s)
作者如何评估自己的方法？实验的 setup 是什么样的？感兴趣实验数据和结果有哪些？有没有问题或者可以借鉴的地方？


## Notes
  单眼monocular 3D HPE 方法：
  1. Lifting 2D to 3D
       - [6, 7, 9, 12, 14, 28, 33, 41, 49–51, 54]
       - a fully-connected residual network to lift 2D detections to 3D poses[31]: he simplest and very influential approach that commonly serves as a baseline
       - 上述：predict a single most likely pose for a given input. Ours: predict a set of plausible 3D poses from a single 2D pose
  2. Multi-hypothesis 3D human pose estimation: generate multiple diverse hypotheses to cover the ambiguous nature of 3D human pose estimation

## References
(optional)列出相关性高的文献，以便之后可以继续 track 下去。
